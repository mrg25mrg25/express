jwt authentication
// JWT ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶¨‡¶æ‡¶®‡¶æ‡¶®‡ßã‡¶∞ ‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø ‡¶á‡¶®‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ
const jwt = require('jsonwebtoken');

// Express ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø JWT ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡¶æ‡¶∞ middleware ‡¶á‡¶®‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ
const expressJwt = require('express-jwt');

// ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶¨‡¶æ‡¶®‡¶æ‡¶§‡ßá ‡¶è‡¶¨‡¶Ç ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡¶§‡ßá ‡¶è‡¶á ‡¶∏‡¶ø‡¶ï‡ßç‡¶∞‡ßá‡¶ü ‡¶ö‡¶æ‡¶¨‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨
const SECRET = 'your-jwt-secret';

// ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá
app.post('/login', (req, res) => {
  // ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ß‡¶∞‡ßá ‡¶®‡¶ø‡¶ö‡ßç‡¶õ‡¶ø ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶†‡¶ø‡¶ï ‡¶Ü‡¶õ‡ßá (‡¶¨‡¶æ‡¶∏‡ßç‡¶§‡¶¨‡ßá ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶ú ‡¶•‡ßá‡¶ï‡ßá ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡ßü)
  const user = { id: 1, username: 'admin' };

  // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡ßü‡ßá JWT ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ, ‡¶Ø‡ßá‡¶ü‡¶æ ‡ßß ‡¶ò‡¶£‡ßç‡¶ü‡¶æ ‡¶ö‡¶≤‡¶¨‡ßá
  const token = jwt.sign(user, SECRET, { expiresIn: '1h' });

  // ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶ï‡ßá ‡¶∞‡ßá‡¶∏‡¶™‡¶®‡ßç‡¶∏ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶™‡¶æ‡¶†‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶≤‡¶æ‡¶Æ
  res.json({ token });
});

// ‡¶è‡¶á ‡¶∞‡¶æ‡¶â‡¶ü‡¶ü‡¶æ ‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞, ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶õ‡¶æ‡ßú‡¶æ ‡¶ï‡ßá‡¶â ‡¶¢‡ßÅ‡¶ï‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá ‡¶®‡¶æ
app.get('/protected', expressJwt({ secret: SECRET }), (req, res) => {
  // ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶∏‡¶†‡¶ø‡¶ï ‡¶π‡¶≤‡ßá ‡¶è‡¶á ‡¶°‡¶æ‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá
  res.send('Protected data');
});

// ‡¶Ø‡¶¶‡¶ø ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶≠‡ßÅ‡¶≤ ‡¶π‡ßü ‡¶¨‡¶æ ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶è‡¶∞‡¶∞ ‡¶ß‡¶∞‡¶¨‡ßã
app.use((err, req, res, next) => {
  // ‡¶Ø‡¶¶‡¶ø ‡¶è‡¶∞‡¶∞ ‡¶π‡ßü ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§, ‡¶§‡¶æ‡¶π‡¶≤‡ßá 401 ‡¶¶‡¶ø‡ßü‡ßá ‡¶ú‡¶æ‡¶®‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶¨
  if(err.name === 'UnauthorizedError') {
    res.status(401).send('Invalid token');
  }
});
//‚Ä¶..............‚Ä¶‚Ä¶





// express-rate-limit

// JWT ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶¨‡¶æ‡¶®‡¶æ‡¶®‡ßã‡¶∞ ‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø ‡¶á‡¶®‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ
const jwt = require('jsonwebtoken');

// Express ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø JWT ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡¶æ‡¶∞ middleware ‡¶á‡¶®‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ
const expressJwt = require('express-jwt');

// Rate limit middleware ‡¶á‡¶®‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ
const rateLimit = require('express-rate-limit');

// ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶¨‡¶æ‡¶®‡¶æ‡¶§‡ßá ‡¶è‡¶¨‡¶Ç ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡¶§‡ßá ‡¶è‡¶á ‡¶∏‡¶ø‡¶ï‡ßç‡¶∞‡ßá‡¶ü ‡¶ö‡¶æ‡¶¨‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨
const SECRET = 'your-jwt-secret';

// Rate limiter ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ: ‡ßß ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü‡ßá ‡¶è‡¶ï‡¶ú‡¶® ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡ß´‡¶¨‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßÅ‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá
const limiter = rateLimit({
  windowMs: 1 * 60 * 1000, // ‡ßß ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü
  max: 5, // ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ß´ ‡¶¨‡¶æ‡¶∞
  message: 'Too many requests, please try again later.' // ‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü ‡¶™‡ßá‡¶∞‡¶æ‡¶≤‡ßá ‡¶è‡¶á ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶¶‡¶ø‡¶¨‡ßá
});

// ‡¶≤‡¶ó‡¶á‡¶® ‡¶∞‡¶æ‡¶â‡¶ü‡ßá ‡¶∞‡ßá‡¶ü ‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶æ‡¶á ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ
app.post('/login', limiter, (req, res) => {
  // ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ß‡¶∞‡ßá ‡¶®‡¶ø‡¶ö‡ßç‡¶õ‡¶ø ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶†‡¶ø‡¶ï ‡¶Ü‡¶õ‡ßá (‡¶¨‡¶æ‡¶∏‡ßç‡¶§‡¶¨‡ßá ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶ú ‡¶•‡ßá‡¶ï‡ßá ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡ßü)
  const user = { id: 1, username: 'admin' };

  // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡ßü‡ßá JWT ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ, ‡¶Ø‡ßá‡¶ü‡¶æ ‡ßß ‡¶ò‡¶£‡ßç‡¶ü‡¶æ ‡¶ö‡¶≤‡¶¨‡ßá
  const token = jwt.sign(user, SECRET, { expiresIn: '1h' });

  // ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶ï‡ßá ‡¶∞‡ßá‡¶∏‡¶™‡¶®‡ßç‡¶∏ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶™‡¶æ‡¶†‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶≤‡¶æ‡¶Æ
  res.json({ token });
});

// ‡¶è‡¶á ‡¶∞‡¶æ‡¶â‡¶ü‡¶ü‡¶æ ‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞, ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶õ‡¶æ‡ßú‡¶æ ‡¶ï‡ßá‡¶â ‡¶¢‡ßÅ‡¶ï‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá ‡¶®‡¶æ
app.get('/protected', expressJwt({ secret: SECRET, algorithms: ['HS256'] }), (req, res) => {
  // ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶∏‡¶†‡¶ø‡¶ï ‡¶π‡¶≤‡ßá ‡¶è‡¶á ‡¶°‡¶æ‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá
  res.send('Protected data');
});

// ‡¶Ø‡¶¶‡¶ø ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶≠‡ßÅ‡¶≤ ‡¶π‡ßü ‡¶¨‡¶æ ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶è‡¶∞‡¶∞ ‡¶ß‡¶∞‡¶¨‡ßã
app.use((err, req, res, next) => {
  // ‡¶Ø‡¶¶‡¶ø ‡¶è‡¶∞‡¶∞ ‡¶π‡ßü ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§, ‡¶§‡¶æ‡¶π‡¶≤‡ßá 401 ‡¶¶‡¶ø‡ßü‡ßá ‡¶ú‡¶æ‡¶®‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶¨
  if(err.name === 'UnauthorizedError') {
    res.status(401).send('Invalid token');
  }
});
//...................






// Mongoose ‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø ‡¶á‡¶®‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ (MongoDB ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)
const mongoose = require('mongoose');

// MongoDB ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡¶∂‡¶® ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ
mongoose.connect('mongodb://localhost:27017/mydb', {
  useNewUrlParser: true,        // ‡¶®‡¶§‡ßÅ‡¶® URL ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨‡ßã
  useUnifiedTopology: true      // ‡¶á‡¶â‡¶®‡¶ø‡¶´‡¶æ‡¶á‡¶° ‡¶ü‡¶™‡ßã‡¶≤‡¶ú‡¶ø ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶¨‡ßã (‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ)
})
.then(() => console.log('MongoDB connected'))  // ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡¶∂‡¶® ‡¶∏‡¶´‡¶≤ ‡¶π‡¶≤‡ßá ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶¶‡¶ø‡¶¨‡ßá
.catch(err => console.error('Connection error:', err)); // ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡¶∂‡¶®‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶≤‡ßá ‡¶è‡¶∞‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá

// ‡¶è‡¶ï‡¶ü‡¶ø ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶¨‡¶æ‡¶®‡¶æ‡¶≤‡¶æ‡¶Æ (Schema ‡¶õ‡¶æ‡ßú‡¶æ‡¶ì ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶∏‡¶∞‡¶≤‡¶§‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)
const User = mongoose.model('User', {
  name: String,   // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞ ‡¶π‡¶¨‡ßá
  email: String   // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞ ‡¶π‡¶¨‡ßá
});

// POST ‡¶∞‡¶æ‡¶â‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ: ‡¶®‡¶§‡ßÅ‡¶® ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶®‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
app.post('/users', async (req, res) => {
  try {
    // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ ‡¶∞‡¶ø‡¶ï‡ßÅ‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶°‡ßá‡¶ü‡¶æ ‡¶¶‡¶ø‡ßü‡ßá
    const user = new User(req.body);

    // ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá ‡¶∏‡ßá‡¶á‡¶≠ ‡¶ï‡¶∞‡¶≤‡¶æ‡¶Æ
    await user.save();

    // ‡ß®‡ß¶‡ßß ‡¶Æ‡¶æ‡¶®‡ßá: Created. ‡¶∏‡ßá‡¶á‡¶≠ ‡¶∏‡¶´‡¶≤ ‡¶π‡¶≤‡ßá ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶ï‡ßá ‡¶∞‡ßá‡¶∏‡¶™‡¶®‡ßç‡¶∏ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶≤‡¶æ‡¶Æ
    res.status(201).send(user);
  } catch (err) {
    // ‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶∞‡¶∞ ‡¶π‡¶≤‡ßá ‡ß™‡ß¶‡ß¶ (Bad Request) ‡¶¶‡¶ø‡ßü‡ßá ‡¶è‡¶∞‡¶∞ ‡¶™‡¶æ‡¶†‡¶æ‡¶≤‡¶æ‡¶Æ
    res.status(400).send(err);
  }
});
///////////////////////////////





 

// supertest ‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø ‡¶¶‡¶ø‡ßü‡ßá HTTP ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø request ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶Ü‡¶®‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá
const request = require('supertest');
// ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá‡¶∞ ‡¶Æ‡ßá‡¶á‡¶® ‡¶´‡¶æ‡¶á‡¶≤ (‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá express app ‡¶¨‡¶æ‡¶®‡¶æ‡¶®‡ßã ‡¶π‡ßü) ‡¶á‡¶Æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá
const app = require('../app');

// describe ‡¶¨‡ßç‡¶≤‡¶ï‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞‡ßá 'GET /api/users' ‡¶∞‡ßÅ‡¶ü ‡¶è‡¶∞ ‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶∂‡ßÅ‡¶∞‡ßÅ
describe('GET /api/users', () => {

  // ‡¶è‡¶á ‡¶ü‡ßá‡¶∏‡ßç‡¶ü‡¶ü‡¶æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßá ‡¶∏‡¶¨ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶´‡¶ø‡¶∞‡¶æ‡ßü ‡¶ï‡¶ø‡¶®‡¶æ
  it('should return all users', async () => {
    const res = await request(app)         // app ‡¶è‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã
      .get('/api/users')                   // GET ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü
      .expect(200);                        // HTTP status 200 ‡¶Ü‡¶∂‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü

    expect(Array.isArray(res.body)).toBeTruthy(); // ‡¶∞‡ßá‡¶∏‡¶™‡¶®‡ßç‡¶∏ ‡¶¨‡¶°‡¶ø ‡¶è‡¶ï‡¶ü‡¶æ array ‡¶ï‡¶ø‡¶®‡¶æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü
  });

  // ‡¶è‡¶á ‡¶ü‡ßá‡¶∏‡ßç‡¶ü‡¶ü‡¶æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡ßü ‡¶ï‡¶ø‡¶®‡¶æ
  it('should create a new user', async () => {
    const res = await request(app)             // app ‡¶è‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã
      .post('/api/users')                      // POST ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü
      .send({ name: 'John', email: 'john@example.com' }) // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã
      .expect(201);                            // HTTP status 201 ‡¶Ü‡¶∂‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü (Created)

    expect(res.body.name).toBe('John');        // ‡¶∞‡ßá‡¶∏‡¶™‡¶®‡ßç‡¶∏ ‡¶¨‡¶°‡¶ø‡¶§‡ßá name ‡¶†‡¶ø‡¶ï ‡¶Ü‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü
  });

});
////////////////////






// Express ‡¶´‡ßç‡¶∞‡ßá‡¶Æ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶ß‡¶∞‡ßá ‡¶®‡¶ø‡¶ö‡ßç‡¶õ‡¶ø
const express = require('express');   // Express ‡¶á‡¶Æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ
const app = express();                // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ

// Health check endpoint ‡¶§‡ßà‡¶∞‡¶ø
app.get('/health', (req, res) => {        // ‡¶Ø‡¶ñ‡¶® ‡¶ï‡ßá‡¶â '/health' ‡¶∞‡¶æ‡¶â‡¶ü‡ßá GET ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶¨‡ßá
  res.status(200).send('Server is healthy'); // ‡¶§‡¶ñ‡¶® ‡ß®‡ß¶‡ß¶ status ‡¶¶‡¶ø‡ßü‡ßá "Server is healthy" ‡¶™‡¶æ‡¶†‡¶æ‡¶¨‡ßá
});

// ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ
app.listen(3000, () => {
  console.log('Server is running on port 3000');
});
/////////////////ü´£ü´£ü´£ü´£








// express-validator ‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø ‡¶•‡ßá‡¶ï‡ßá body ‡¶ì validationResult ‡¶á‡¶Æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá
const { body, validationResult } = require('express-validator');

// POST /users ‡¶∞‡¶æ‡¶â‡¶ü ‡¶°‡¶ø‡¶´‡¶æ‡¶á‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá
app.post('/users', 
  [
    // email ‡¶´‡¶ø‡¶≤‡ßç‡¶°‡¶ü‡¶æ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶° ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶ï‡¶ø‡¶®‡¶æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßá, ‡¶§‡¶æ‡¶∞‡¶™‡¶∞ normalize ‡¶ï‡¶∞‡ßá (lowercase + trim)
    body('email').isEmail().normalizeEmail(),
    
    // password ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ß¨ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞‡ßá‡¶∞ ‡¶ï‡¶ø‡¶®‡¶æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü
    body('password').isLength({ min: 6 })
  ],
  (req, res) => {
    // validation result ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá
    const errors = validationResult(req);
    
    // ‡¶Ø‡¶¶‡¶ø ‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶∞‡¶∞ ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá 400 status ‡¶¶‡¶ø‡ßü‡ßá error ‡¶ó‡ßÅ‡¶≤‡¶æ ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá
    if (!errors.isEmpty()) {
      return res.status(400).json({ errors: errors.array() });
    }
    
    // ‡¶Ø‡¶¶‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶° ‡¶π‡ßü, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶è‡¶á ‡¶ú‡¶æ‡ßü‡¶ó‡¶æ‡ßü ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏ (create) ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá
    res.send('User created successfully');
  }
);
///////???/////////











